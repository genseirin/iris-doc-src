parameters: []
post:
  summary: Create a new ioc
  operationId: post-api-v2-cases-ioc
  responses:
    '200':
       content:
        application/json:
          schema:
            type: object
            properties:
              data:
                type: object
                properties:
                  ioc_description:
                    type: string
                    minLength: 1
                  ioc_id:
                    type: number
                  ioc_misp: { }
                  ioc_tags:
                    type: string
                  ioc_tlp_id:
                    type: number
                  ioc_type:
                    type: number
                  ioc_type_id:
                    type: number
                  ioc_value:
                    type: string
                    minLength: 1
                  user_id:
                    type: number
                required:
                  - ioc_description
                  - ioc_id
                  - ioc_tags
                  - ioc_tlp_id
                  - ioc_type
                  - ioc_type_id
                  - ioc_value
                  - user_id
       message:
         type: string
         minLength: 1
         status:
           type: string
           minLength: 1
         required:
           - data
           - message
           - status
         x-examples:
           example-1:
             data:
               ioc_description: rewrw
               ioc_id: 34
               ioc_misp: null
               ioc_tags: ''
               ioc_tlp_id: 2
               ioc_type: 1
               ioc_type_id: 1
               ioc_value: 8.8.8.8
               user_id: 1
             message: IOC added
             status: success
         examples:
           Success:
             value:
               data:
                 ioc_description: rewrw
                 ioc_id: 34
                 ioc_misp: null
                 ioc_tags: ''
                 ioc_tlp_id: 2
                 ioc_type: 1
                 ioc_type_id: 1
                 ioc_value: 8.8.8.8
                 user_id: 1
               message: IOC added
               status: success
           IOC Already exists in DB:
             value:
               data:
                 ioc_description: rewrw
                 ioc_id: 34
                 ioc_misp: null
                 ioc_tags: ''
                 ioc_tlp_id: 2
                 ioc_type: 1
                 ioc_type_id: 1
                 ioc_value: 8.8.8.8
                 user_id: 1
               message: IOC already existed in DB. Updated with info on DB.
               status: success
         '400':
           description: Bad Request
           content:
             application/json:
               schema:
                 description: ''
                 type: object
                 x-examples:
                   example-1:
                     data:
                       ioc_descrption:
                         - Unknown field.
                     message: Data error
                     status: error
                     properties:
                       data:
                         type: object
                       message:
                         type: string
                         minLength: 1
                       status:
                         type: string
                         minLength: 1
                     required:
                       - data
                       - message
                       - status
                     examples: { }
                     description: ''
                     parameters: [ ]
                     security:
                       - Bearer <bearer>: [ ]
                     requestBody:
                       content:
                         application/json:
                           schema:
                             description: ''
                             type: object
                             x-examples:
                               example-1:
                                 ioc_type: IP
                                 ioc_tlp_id: '2'
                                 ioc_value: rrewre
                                 ioc_description: rewrw
                                 ioc_tags: rewr
                                 cid: 12
                             properties:
                               ioc_type_id:
                                 type: integer
                               ioc_tlp_id:
                                 type: integer
                               ioc_value:
                                 type: string
                                 minLength: 1
                               ioc_description:
                                 type: string
                                 minLength: 1
                               ioc_tags:
                                 type: string
                               cid:
                                 type: integer
                             required:
                               - ioc_type_id
                               - ioc_tlp_id
                               - ioc_value
                               - ioc_description
                               - ioc_tags
                               - cid
                           examples:
                             example-1:
                               value:
                                 ioc_type_id: 1
                                 ioc_tlp_id: 2
                                 ioc_value: 8.8.8.8
                                 ioc_description: rewrw
                                 ioc_tags: ''
                                 cid: 2
                       description: ''
    post:
      summary: Delete an IOC
      operationId: delete-api-v2-cases-ioc
    responses:
      '200':
        description: OK
        content:
          application/json:
            schema:
              type: object
              properties:
                status:
                  type: string
                message:
                  type: string
                data:
                  type: array
                  items:
                    type: object
                    properties: { }
              x-examples:
                Example 1:
                  status: success
                  message: IOC 3956 deleted
                  data: [ ]
            examples:
              Success 1:
                value:
                  status: success
                  message: IOC 3956 deleted
                  data: [ ]
              Success unlink:
                value:
                  data: [ ]
                  message: IOC unlinked
                  status: success
      '400':
        description: Bad Request
        content:
          application/json:
            schema:
              description: ''
              type: object
              properties:
                data:
                  type: array
                  items:
                    properties: { }
                message:
                  type: string
                  minLength: 1
                status:
                  type: string
                  minLength: 1
              required:
                - data
                - message
                - status
              x-examples:
                example-1:
                  data: [ ]
                  message: Invalid group ID
                  status: error
            examples:
              Invalid IOC  ID:
                value:
                  data: [ ]
                  message: Not a valid IOC for this case
                  status: error
    operationId: delete-case-ioc
    description: 'Delete an IOC from the case. If the IOC is still reference in other cases than it''s only unlinked from the current case. '
    security:
      - Bearer <bearer>: [ ]
    parameters:
      - schema:
          type: string
        in: query
        name: cid
        description: Case ID
        required: true
  tags:
      - Case IOC
  parameters: [ { schema: { type: integer }, name: ioc_id, in: path, required: true } ]
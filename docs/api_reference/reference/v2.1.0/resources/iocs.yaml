parameters: []
post:
  summary: Create a new ioc
  operationId: post-api-v2-cases-ioc
  responses:
    '200':
       content:
        application/json:
          schema:
            type: object
            properties:
              data:
                type: object
                properties:
                  ioc_description:
                    type: string
                    minLength: 1
                  ioc_id:
                    type: number
                  ioc_misp: { }
                  ioc_tags:
                    type: string
                  ioc_tlp_id:
                    type: number
                  ioc_type:
                    type: number
                  ioc_type_id:
                    type: number
                  ioc_value:
                    type: string
                    minLength: 1
                  user_id:
                    type: number
                required:
                  - ioc_description
                  - ioc_id
                  - ioc_tags
                  - ioc_tlp_id
                  - ioc_type
                  - ioc_type_id
                  - ioc_value
                  - user_id
       message:
         type: string
         minLength: 1
         status:
           type: string
           minLength: 1
         required:
           - data
           - message
           - status
         x-examples:
           example-1:
             data:
               ioc_description: rewrw
               ioc_id: 34
               ioc_misp: null
               ioc_tags: ''
               ioc_tlp_id: 2
               ioc_type: 1
               ioc_type_id: 1
               ioc_value: 8.8.8.8
               user_id: 1
             message: IOC added
             status: success
         examples:
           Success:
             value:
               data:
                 ioc_description: rewrw
                 ioc_id: 34
                 ioc_misp: null
                 ioc_tags: ''
                 ioc_tlp_id: 2
                 ioc_type: 1
                 ioc_type_id: 1
                 ioc_value: 8.8.8.8
                 user_id: 1
               message: IOC added
               status: success
           IOC Already exists in DB:
             value:
               data:
                 ioc_description: rewrw
                 ioc_id: 34
                 ioc_misp: null
                 ioc_tags: ''
                 ioc_tlp_id: 2
                 ioc_type: 1
                 ioc_type_id: 1
                 ioc_value: 8.8.8.8
                 user_id: 1
               message: IOC already existed in DB. Updated with info on DB.
               status: success
         '400':
           description: Bad Request
           content:
             application/json:
               schema:
                 description: ''
                 type: object
                 x-examples:
                   example-1:
                     data:
                       ioc_descrption:
                         - Unknown field.
                     message: Data error
                     status: error
                     properties:
                       data:
                         type: object
                       message:
                         type: string
                         minLength: 1
                       status:
                         type: string
                         minLength: 1
                     required:
                       - data
                       - message
                       - status
                     examples: { }
                     description: ''
                     parameters: [ ]
                     security:
                       - Bearer <bearer>: [ ]
                     requestBody:
                       content:
                         application/json:
                           schema:
                             description: ''
                             type: object
                             x-examples:
                               example-1:
                                 ioc_type: IP
                                 ioc_tlp_id: '2'
                                 ioc_value: rrewre
                                 ioc_description: rewrw
                                 ioc_tags: rewr
                                 cid: 12
                             properties:
                               ioc_type_id:
                                 type: integer
                               ioc_tlp_id:
                                 type: integer
                               ioc_value:
                                 type: string
                                 minLength: 1
                               ioc_description:
                                 type: string
                                 minLength: 1
                               ioc_tags:
                                 type: string
                               cid:
                                 type: integer
                             required:
                               - ioc_type_id
                               - ioc_tlp_id
                               - ioc_value
                               - ioc_description
                               - ioc_tags
                               - cid
                           examples:
                             example-1:
                               value:
                                 ioc_type_id: 1
                                 ioc_tlp_id: 2
                                 ioc_value: 8.8.8.8
                                 ioc_description: rewrw
                                 ioc_tags: ''
                                 cid: 2
                       description: ''